<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>math</title>
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
        />
        <script
            defer
            src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
        ></script>
        <style>
            html, body {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100%;
                background: #000000;
                color: #cccccc;

                /* 中央寄せ */
                display: flex;
                justify-content: center; /* 横方向中央 */
                align-items: center;     /* 縦方向中央 */
            }

            #container {
                display: inline-block;
                padding: 8px;
            }

            #math {
                font-size: 32px;
            }
        </style>
    </head>
    <body>
        <div id="container" class="capture">
            <div id="math"></div>
        </div>

        <script>
            function getLatexFromHash() {
                if (!location.hash || location.hash.length <= 1) {
                    return "Null"; // デフォルト（ハッシュ無いとき）
                }
                // 先頭の # を除いて URL デコード
                const raw = location.hash.slice(1);
                try {
                    return decodeURIComponent(raw);
                } catch (e) {
                    console.error("Failed to decode hash:", e);
                    return raw; // デコード失敗したらそのまま
                }
            }

            window.addEventListener("load", () => {
                const expr = getLatexFromHash();
                const el = document.getElementById("math");
                try {
                    katex.render(expr, el, {
                        displayMode: true,
                        throwOnError: true,   // LaTeX エラーだけ拾う
                    });
                } catch (e) {
                    const errorExpr =
                        "\\begin{array}{c}" +
                        "\\scriptstyle\\text{(Invalid LaTeX expression)}\\\\[1ex]" +
                        expr +
                        "\\end{array}";

                    katex.render(errorExpr, el, {
                        displayMode: true,
                        throwOnError: false,
                    });
                }
            });

        </script>
    </body>
</html>
